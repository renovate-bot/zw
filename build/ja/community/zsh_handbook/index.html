<!doctype html>
<html class="docs-version-current" lang="ja" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v0.0.0-4727">
<link rel="alternate" type="application/rss+xml" href="/ja/blog/rss.xml" title="❮ ZI ❯ RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/ja/blog/atom.xml" title="❮ ZI ❯ Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-MT10GVL59X"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-MT10GVL59X",{anonymize_ip:!0})</script>
<link rel="search" type="application/opensearchdescription+xml" title="❮ ZI ❯" href="/ja/opensearch.xml">
<link rel="icon" href="/ja/zw/logo.svg">
<link rel="manifest" href="/ja/manifest.json">
<link rel="browserconfig" href="/ja/browserconfig.xml">
<meta name="theme-color" content="rgb(35, 184, 152)">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#000">
<link rel="apple-touch-icon" href="/ja/zw/logo.png">
<meta name="msapplication-TileImage" content="/ja/zw/logo.png">
<meta name="msapplication-TileColor" content="#000">
<script src="https://kit.fontawesome.com/a6c194e645.js" crossorigin="anonymous"></script>
<script src="https://enterprise.crowdin.com/crowdjet/crowdjet.js"></script><title data-rh="true">Zsh Native Scripting Handbook | ❮ ZI ❯</title><meta data-rh="true" property="og:image" content="https://z.digitalclouds.dev/ja/zw/logo/320x320.png"><meta data-rh="true" name="twitter:image" content="https://z.digitalclouds.dev/ja/zw/logo/320x320.png"><meta data-rh="true" property="og:url" content="https://z.digitalclouds.dev/ja/community/zsh_handbook"><meta data-rh="true" name="docusaurus_locale" content="ja"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-community-current"><meta data-rh="true" name="docsearch:language" content="ja"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-community-current"><meta data-rh="true" name="twitter:card" content="summary"><meta data-rh="true" property="og:title" content="Zsh Native Scripting Handbook | ❮ ZI ❯"><meta data-rh="true" name="description" content="Information"><meta data-rh="true" property="og:description" content="Information"><link data-rh="true" rel="icon" href="/ja/zw/favicon.ico"><link data-rh="true" rel="canonical" href="https://z.digitalclouds.dev/ja/community/zsh_handbook"><link data-rh="true" rel="alternate" href="https://z.digitalclouds.dev/community/zsh_handbook" hreflang="en"><link data-rh="true" rel="alternate" href="https://z.digitalclouds.dev/ja/community/zsh_handbook" hreflang="ja"><link data-rh="true" rel="alternate" href="https://z.digitalclouds.dev/ru/community/zsh_handbook" hreflang="ru"><link data-rh="true" rel="alternate" href="https://z.digitalclouds.dev/zh-Hans/community/zsh_handbook" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://z.digitalclouds.dev/community/zsh_handbook" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://8A6CKETM6G-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/ja/assets/css/styles.1184d903.css">
<link rel="preload" href="/ja/assets/js/runtime~main.40e568a4.js" as="script">
<link rel="preload" href="/ja/assets/js/main.5536902d.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):window.matchMedia("(prefers-color-scheme: light)").matches?t("light"):t("dark")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_cIvR">メインコンテンツまでスキップ</a></div><div class="announcementBar_o_kh" role="banner"><div class="announcementBarPlaceholder_vtkT"></div><div class="announcementBarContent_c7Z7">If you like ❮ ZI ❯ - give it a <a target="_blank" rel="noopener noreferrer" href="https://github.com/z-shell/zi">⭐️</a> and follow us on <a target="_blank" rel="noopener noreferrer" href="https://github.com/z-shell"><i class="fa-brands fa-github-alt" width="16" height="16">GitHub</i></a> or <a target="_blank" rel="noopener noreferrer" href="https://twitter.com/zshell_zi"><i class="fa-brands fa-twitter" width="16" height="16">Twitter</i></a></div><button type="button" class="clean-btn close announcementBarClose_rZAK" aria-label="閉じる"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav class="navbar navbar--fixed-top navbarHideable_zaDa"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" target="_self" href="/ja/"><div class="navbar__logo"><img src="/ja/zw/logo.svg" alt="❮ ZI ❯ Logo" class="themedImage_ocox themedImage--light_jDDz" height="32" width="32"><img src="/ja/zw/logo.svg" alt="❮ ZI ❯ Logo" class="themedImage_ocox themedImage--dark_MPXm" height="32" width="32"></div><b class="navbar__title">❮ ZI ❯</b></a><a class="navbar__item navbar__link" href="/ja/docs/intro"><span>Docs</span></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link"><span><span><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_f3pI"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg><span>日本語</span></span></span></a><ul class="dropdown__menu"><li><a href="/community/zsh_handbook" target="_self" rel="noopener noreferrer" class="dropdown__link"><span>English</span></a></li><li><a href="/ja/community/zsh_handbook" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active"><span>日本語</span></a></li><li><a href="/ru/community/zsh_handbook" target="_self" rel="noopener noreferrer" class="dropdown__link"><span>Русский</span></a></li><li><a href="/zh-Hans/community/zsh_handbook" target="_self" rel="noopener noreferrer" class="dropdown__link"><span>简体中文</span></a></li><li><a href="https://digitalclouds.crowdin.com/z-shell" target="_blank" rel="noopener noreferrer" class="dropdown__link"><span>Help Us Translate<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_N6EJ"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><a href="https://github.com/z-shell/zi/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"><span></span></a><div class="toggle_IfB0 toggle_kEn3 toggleDisabled_WHmG"><div class="toggleButton_BZAX" role="button" tabindex="-1"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_SNFM"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_lqKs"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></div><input type="checkbox" checked="" class="toggleScreenReader_IO1O" aria-label="Switch between dark and light mode (currently dark mode)"></div><div class="searchBox_F0Md"><button type="button" class="DocSearch DocSearch-Button" aria-label="検索"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">検索</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_vVol"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_k7oR" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_TANK"><div class="sidebar_UgbA sidebarWithHideableNavbar_u__6"><a tabindex="-1" class="sidebarLogo_sIEQ" target="_self" href="/ja/"><img src="/ja/zw/logo.svg" alt="❮ ZI ❯ Logo" class="themedImage_ocox themedImage--light_jDDz" height="32" width="32"><img src="/ja/zw/logo.svg" alt="❮ ZI ❯ Logo" class="themedImage_ocox themedImage--dark_MPXm" height="32" width="32"><b>❮ ZI ❯</b></a><nav class="menu thin-scrollbar menu_dxFf menuWithAnnouncementBar_Se5v"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ja/community/intro"><span>Zsh Knowledge Base</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ja/community/zsh_plugin_standard"><span>Zsh Plugin Standard</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/ja/community/zsh_handbook"><span>Zsh Native Scripting Handbook</span></a></li></ul></nav><button type="button" title="サイドバーを隠す" aria-label="サイドバーを隠す" class="button button--secondary button--outline collapseSidebarButton_sUbj"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_I3h7"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_GFc_"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_aSGu"><div class="docItemContainer_D8F8"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_N6BI" aria-label="breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a class="breadcrumbs__link breadcrumbsItemLink_mIMU" href="/ja/">🏠</a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><a class="breadcrumbs__link breadcrumbsItemLink_mIMU" itemprop="item" href="/ja/community/zsh_handbook"><span itemprop="name">Zsh Native Scripting Handbook</span></a><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_FVtW theme-doc-toc-mobile tocMobile_YBih"><button type="button" class="clean-btn tocCollapsibleButton_I6CC">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Zsh Native Scripting Handbook</h1></header><h2 class="anchor anchorWithHideOnScrollNavbar_I3q0" id="information">Information<a class="hash-link" href="#information" title="見出しへの直接リンク">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_I3q0" id="-is-about-keeping-array-form">@ is about keeping array form<a class="hash-link" href="#-is-about-keeping-array-form" title="見出しへの直接リンク">​</a></h3><p>How to access all array elements in a shell? The standard answer: <code>use @ subscript</code>, i.e. <code>${array[@]}</code>. However, this
is the Bash &amp; Ksh way (and with the option <code>KSH_ARRAYS</code>, Zsh also works this way, i.e. needs <code>@</code> to access the whole
array). Z shell <strong>is different</strong>: it is <code>$array</code> that refers to all elements anyway. There is no need for the <code>@</code>
subscript.</p><p>So what use has <code>@</code> in the Zsh-world? It is: &quot;<code>keep array form</code>&quot; or &quot;<code>do not join</code>&quot;. When is it activated? When the user
quotes the array, i.e. invokes <code>&quot;$array&quot;</code>, he induces <em>joining</em> of all array elements (into a single string). <code>@</code> is to
have elements still quoted (so empty elements are preserved), but not joined.</p><p>Two forms are available, <code>&quot;$array[@]&quot;</code> and <code>&quot;${(@)array}&quot;</code>. The first form has an additional effect – when an option
<code>KSH_ARRAYS</code> is set, it indeed induces referencing to the whole array instead of a first element only. It should then
use braces, i.e. <code>${array[@]}</code>, <code>&quot;${array[@]}&quot;</code> (<code>KSH_ARRAYS</code> requirement).</p><p>In practice, if you&#x27;ll use <code>@</code> as a subscript – <code>[@]</code>, not as a flag – <code>${(@)...}</code>, then you&#x27;ll make the code
<code>KSH_ARRAYS</code>-compatible.</p><h3 class="anchor anchorWithHideOnScrollNavbar_I3q0" id="extended_glob">extended_glob<a class="hash-link" href="#extended_glob" title="見出しへの直接リンク">​</a></h3><p>Glob-flags <code>#b</code> and <code>#m</code> require <code>setopt extended_glob</code>. Patterns utilizing <code>~</code> and <code>^</code> also require it. Extended-glob
is one of the main features of Zsh.</p><h2 class="anchor anchorWithHideOnScrollNavbar_I3q0" id="constructs">Constructs<a class="hash-link" href="#constructs" title="見出しへの直接リンク">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_I3q0" id="reading-a-file">Reading a file<a class="hash-link" href="#reading-a-file" title="見出しへの直接リンク">​</a></h3><div class="codeBlockContainer_NBvI language-shell theme-code-block"><div class="codeBlockContent_yvht shell"><pre tabindex="0" class="prism-code language-shell codeBlock_JBFj thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_vKmw"><span class="token-line" style="color:#F8F8F2"><span class="token builtin class-name" style="color:rgb(189, 147, 249)">declare</span><span class="token plain"> -a lines</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">lines</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;${(@f)&quot;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">&lt;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">path/file</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;}&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><button type="button" aria-label="クリップボードにコードをコピー" class="copyButton_RlMu clean-btn">コピー</button></div></div><p>This preserves empty lines because of double-quoting (the outside one). <code>@</code>-flag is used to obtain an array instead of a
scalar. If you don&#x27;t want empty lines preserved, you can also skip <code>@</code>-splitting, as is explained in the
<a href="#information">Information</a> section:</p><div class="codeBlockContainer_NBvI language-shell theme-code-block"><div class="codeBlockContent_yvht shell"><pre tabindex="0" class="prism-code language-shell codeBlock_JBFj thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_vKmw"><span class="token-line" style="color:#F8F8F2"><span class="token builtin class-name" style="color:rgb(189, 147, 249)">declare</span><span class="token plain"> -a lines</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">lines</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">${(f)&quot;$(&lt;path</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">/</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">file)&quot;}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><button type="button" aria-label="クリップボードにコードをコピー" class="copyButton_RlMu clean-btn">コピー</button></div></div><p>Note: <code>$(&lt;...)</code> construct strips trailing empty lines.</p><h3 class="anchor anchorWithHideOnScrollNavbar_I3q0" id="reading-from-stdin">Reading from stdin<a class="hash-link" href="#reading-from-stdin" title="見出しへの直接リンク">​</a></h3><p>This topic is governed by the same principles a the previous paragraph (<code>Reading a file</code>), with the single difference
that instead of the substitution <code>&quot;$(&lt;file-path)&quot;</code> the substitution that should be used is <code>&quot;$(command arg1 ...)&quot;</code>,
i.e.:</p><div class="codeBlockContainer_NBvI language-shell theme-code-block"><div class="codeBlockContent_yvht shell"><pre tabindex="0" class="prism-code language-shell codeBlock_JBFj thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_vKmw"><span class="token-line" style="color:#F8F8F2"><span class="token builtin class-name" style="color:rgb(189, 147, 249)">declare</span><span class="token plain"> -a lines</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">lines</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">${(f)&quot;$(command arg1 ...)&quot;}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><button type="button" aria-label="クリップボードにコードをコピー" class="copyButton_RlMu clean-btn">コピー</button></div></div><p>This will read the <code>command&#x27;s</code> output into the array <code>lines</code>. The version that does <code>@</code> splitting and retains any empty
lines are:</p><div class="codeBlockContainer_NBvI language-shell theme-code-block"><div class="codeBlockContent_yvht shell"><pre tabindex="0" class="prism-code language-shell codeBlock_JBFj thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_vKmw"><span class="token-line" style="color:#F8F8F2"><span class="token builtin class-name" style="color:rgb(189, 147, 249)">declare</span><span class="token plain"> -a lines</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">lines</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">${(f@)$(command arg1 ...)}</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><button type="button" aria-label="クリップボードにコードをコピー" class="copyButton_RlMu clean-btn">コピー</button></div></div><p>Note that instead of four double-quotes <code>&quot;</code>, an idiom that is justified (simply suggested) by the Zsh documentation (and
was used in the previous paragraph, in the snippet <code>... &quot;${(@f)&quot;$(&lt;path/file)&quot;}&quot; ...</code>), only <strong>two</strong> double-quotes are
being used. I&#x27;ve investigated this form with the main Zsh developers on the <code>zsh-workers@zsh.org</code> mailing list and it
was clearly stated that single, outside quoting of <code>${(f@)...}</code> substitution works as if it was also separately applied
to <code>$(command ...)</code> (or to <code>$(&lt;file-path)</code>) inner substitution, so the second double-quoting isn&#x27;t needed.</p><h3 class="anchor anchorWithHideOnScrollNavbar_I3q0" id="skipping-dirname-basename">Skipping dirname basename<a class="hash-link" href="#skipping-dirname-basename" title="見出しへの直接リンク">​</a></h3><p><code>dirname</code> and <code>basename</code> can be skipped by:</p><div class="codeBlockContainer_NBvI language-shell theme-code-block"><div class="codeBlockContent_yvht shell"><pre tabindex="0" class="prism-code language-shell codeBlock_JBFj thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_vKmw"><span class="token-line" style="color:#F8F8F2"><span class="token builtin class-name" style="color:rgb(189, 147, 249)">local</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">dirname</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">${</span><span class="token string variable environment constant" style="color:rgb(189, 147, 249);font-style:italic">PWD</span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">:</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">h}</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">local</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">basename</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">${</span><span class="token string variable environment constant" style="color:rgb(189, 147, 249);font-style:italic">PWD</span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">:</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">t}</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><br></span></code></pre><button type="button" aria-label="クリップボードにコードをコピー" class="copyButton_RlMu clean-btn">コピー</button></div></div><p>Read more: <a href="http://zsh.sourceforge.net/Doc/Release/Expansion.html#Modifiers" target="_blank" rel="noopener noreferrer">zsh: 14 Expansion</a>.</p><h3 class="anchor anchorWithHideOnScrollNavbar_I3q0" id="resolve-symlinks">Resolve Symlinks<a class="hash-link" href="#resolve-symlinks" title="見出しへの直接リンク">​</a></h3><p>Symbolic links can be turned into an absolute path with:</p><div class="codeBlockContainer_NBvI language-shell theme-code-block"><div class="codeBlockContent_yvht shell"><pre tabindex="0" class="prism-code language-shell codeBlock_JBFj thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_vKmw"><span class="token-line" style="color:#F8F8F2"><span class="token builtin class-name" style="color:rgb(189, 147, 249)">local</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">absolute_path</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">${</span><span class="token string variable environment constant" style="color:rgb(189, 147, 249);font-style:italic">PWD</span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">:</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">A}</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><br></span></code></pre><button type="button" aria-label="クリップボードにコードをコピー" class="copyButton_RlMu clean-btn">コピー</button></div></div><h3 class="anchor anchorWithHideOnScrollNavbar_I3q0" id="skipping-grep">Skipping grep<a class="hash-link" href="#skipping-grep" title="見出しへの直接リンク">​</a></h3><div class="codeBlockContainer_NBvI language-shell theme-code-block"><div class="codeBlockContent_yvht shell"><pre tabindex="0" class="prism-code language-shell codeBlock_JBFj thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_vKmw"><span class="token-line" style="color:#F8F8F2"><span class="token builtin class-name" style="color:rgb(189, 147, 249)">declare</span><span class="token plain"> -a lines</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">lines</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;${(@f)&quot;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">&lt;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">path/file</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;}&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">declare</span><span class="token plain"> -a grepped</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">grepped</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">${(M)lines</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">:</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">#</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">*query*}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><button type="button" aria-label="クリップボードにコードをコピー" class="copyButton_RlMu clean-btn">コピー</button></div></div><p>To have the <code>grep -v</code> effect, skip the <code>M</code>-flag. To grep case-insensitively, use <code>\#i</code> glob flag (<code>...:#(#i)\*query*}</code>).</p><p>As it can be seen, <code>${...:#...}</code> substitution is filtering of the array, which by default filters-out elements (<code>(M)</code>
flag induces the opposite behavior). When used with string, not an array, it behaves similarly: returns an empty string
when <code>{input_string_var:#pattern}</code> matches the whole input string.</p><p>Side-note: <code>(M)</code> flag can be used also with <code>${(M)var#pattern}</code> and other substitutions, to retain what&#x27;s matched by the
pattern instead of removing that.</p><h4 class="anchor anchorWithHideOnScrollNavbar_I3q0" id="multi-line-matching-like-with-grep">Multi-line matching like with grep<a class="hash-link" href="#multi-line-matching-like-with-grep" title="見出しへの直接リンク">​</a></h4><p>Suppose you have a Subversion repository and want to check if it contains files being not under version control. You
could do this in Bash style like follows:</p><div class="codeBlockContainer_NBvI language-shell theme-code-block"><div class="codeBlockContent_yvht shell"><pre tabindex="0" class="prism-code language-shell codeBlock_JBFj thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_vKmw"><span class="token-line" style="color:#F8F8F2"><span class="token builtin class-name" style="color:rgb(189, 147, 249)">local</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">svn_status</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">svn status</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"> -n </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable builtin class-name" style="color:rgb(189, 147, 249);font-style:italic">echo</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable string variable" style="color:rgb(189, 147, 249);font-style:italic">$svn_status</span><span class="token string variable string" style="color:rgb(255, 121, 198);font-style:italic">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">\</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">grep </span><span class="token string variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">\</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">^</span><span class="token string variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">\</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">?</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">then</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> found</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">fi</span><br></span></code></pre><button type="button" aria-label="クリップボードにコードをコピー" class="copyButton_RlMu clean-btn">コピー</button></div></div><p>Those are 3 forks: for <code>svn status</code>, for <code>echo</code>, and for <code>grep</code>. This can be solved by the <code>:#</code> substitution and <code>(M)</code>
flag described above in this section (just check if the number of matched lines is greater than 0). However, there&#x27;s a
more direct approach:</p><div class="codeBlockContainer_NBvI language-shell theme-code-block"><div class="codeBlockContent_yvht shell"><pre tabindex="0" class="prism-code language-shell codeBlock_JBFj thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_vKmw"><span class="token-line" style="color:#F8F8F2"><span class="token builtin class-name" style="color:rgb(189, 147, 249)">local</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">svn_status</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">svn status</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">nl</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">$&#x27;</span><span class="token string entity" style="color:rgb(255, 121, 198)">\n</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$svn_status</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> *</span><span class="token punctuation" style="color:rgb(248, 248, 242)">((</span><span class="token comment" style="color:rgb(98, 114, 164)">#s)|$nl)\?* ]]; then</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> found</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">fi</span><br></span></code></pre><button type="button" aria-label="クリップボードにコードをコピー" class="copyButton_RlMu clean-btn">コピー</button></div></div><p>This requires <code>extendedglob</code>. The <code>(#s)</code> means: &quot;start of the string&quot;. So <code>((#s)|$nl)</code> means &quot;start of the string OR
preceded by a new-line&quot;.</p><p>If the <code>extendedglob</code> option cannot be used for some reason, this can be achieved also without it, but essentially it
means that alternative (i.e. <code>|</code>) of two versions of the pattern will have to be matched:</p><div class="codeBlockContainer_NBvI language-shell theme-code-block"><div class="codeBlockContent_yvht shell"><pre tabindex="0" class="prism-code language-shell codeBlock_JBFj thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_vKmw"><span class="token-line" style="color:#F8F8F2"><span class="token plain">setopt localoptions noextendedglob</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">local</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">svn_status</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">svn status</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">nl</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">$&#x27;</span><span class="token string entity" style="color:rgb(255, 121, 198)">\n</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$svn_status</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain">?*</span><span class="token operator">|</span><span class="token plain">*</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$nl</span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain">?*</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">then</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> found</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">fi</span><br></span></code></pre><button type="button" aria-label="クリップボードにコードをコピー" class="copyButton_RlMu clean-btn">コピー</button></div></div><p>In general, multi-line matching falls into the following idiom (<code>extended glob</code> version):</p><div class="codeBlockContainer_NBvI language-shell theme-code-block"><div class="codeBlockContent_yvht shell"><pre tabindex="0" class="prism-code language-shell codeBlock_JBFj thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_vKmw"><span class="token-line" style="color:#F8F8F2"><span class="token builtin class-name" style="color:rgb(189, 147, 249)">local</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">needle</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;?&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">required_preceding</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;[[:space:]]#&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">svn status</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> *</span><span class="token punctuation" style="color:rgb(248, 248, 242)">((</span><span class="token comment" style="color:rgb(98, 114, 164)">#s)|$nl)${~required_preceding}${needle}* ]] &amp;&amp; echo found</span><br></span></code></pre><button type="button" aria-label="クリップボードにコードをコピー" class="copyButton_RlMu clean-btn">コピー</button></div></div><p>It does a single fork (calls <code>svn</code> status). The <code>${~variable}</code> means (the<code>~</code> init): &quot;the variable is holding a pattern,
interpret it&quot;. All in all, instead of regular expressions we were using patterns (globs) (see
<a href="#built-in-regular-expressions-engine">this section</a>).</p><h3 class="anchor anchorWithHideOnScrollNavbar_I3q0" id="pattern-matching-in-and-fashion">Pattern matching in AND-fashion<a class="hash-link" href="#pattern-matching-in-and-fashion" title="見出しへの直接リンク">​</a></h3><div class="codeBlockContainer_NBvI language-shell theme-code-block"><div class="codeBlockContent_yvht shell"><pre tabindex="0" class="prism-code language-shell codeBlock_JBFj thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_vKmw"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;abc xyz efg&quot;</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> *abc*~^*efg* </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">&amp;&amp;</span><span class="token plain"> print Match found</span><br></span></code></pre><button type="button" aria-label="クリップボードにコードをコピー" class="copyButton_RlMu clean-btn">コピー</button></div></div><p>The <code>~</code> is a negation -- <code>match \*abc* but not ...</code>. Then, <code>^</code> is also a negation. The effect is:
<code>\*ABC* but not those that don&#x27;t have \*efg*</code> which equals to: <code>\*ABC* but those that have also \*efg*</code>. This is a
regular pattern and it can be used with <code>:#</code> above to search arrays, or with the <code>R</code>-subscript flag to search hashes
(<code>${hsh[\(R)\*pattern*]}</code>), etc. The inventor of those patterns is Mikael Magnusson.</p><h3 class="anchor anchorWithHideOnScrollNavbar_I3q0" id="skipping-tr">Skipping tr<a class="hash-link" href="#skipping-tr" title="見出しへの直接リンク">​</a></h3><div class="codeBlockContainer_NBvI language-shell theme-code-block"><div class="codeBlockContent_yvht shell"><pre tabindex="0" class="prism-code language-shell codeBlock_JBFj thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_vKmw"><span class="token-line" style="color:#F8F8F2"><span class="token builtin class-name" style="color:rgb(189, 147, 249)">declare</span><span class="token plain"> -A map</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">map</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> a </span><span class="token number">1</span><span class="token plain"> b </span><span class="token number">2</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">text</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;ab&quot;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;ba&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">text</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">${text</span><span class="token variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">[</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">@</span><span class="token variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">]</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">/</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">/</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">(</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">#</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">m)?</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">/</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">${map</span><span class="token variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">[</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$MATCH</span><span class="token variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">]</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">print </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$text</span><span class="token plain"> ▶ </span><span class="token number">12</span><span class="token plain"> </span><span class="token number">21</span><br></span></code></pre><button type="button" aria-label="クリップボードにコードをコピー" class="copyButton_RlMu clean-btn">コピー</button></div></div><p><code>#m</code> flag enables the <code>$MATCH</code> parameter. At each <code>//</code> substitution, <code>$map</code> is queried for character-replacement. You
can substitute a text variable too, just skip <code>[@]</code> and parentheses in the assignment.</p><h3 class="anchor anchorWithHideOnScrollNavbar_I3q0" id="ternary-expressions-with----substitutions">Ternary expressions with <code>+,-,:+,:-</code> substitutions<a class="hash-link" href="#ternary-expressions-with----substitutions" title="見出しへの直接リンク">​</a></h3><div class="codeBlockContainer_NBvI language-shell theme-code-block"><div class="codeBlockContent_yvht shell"><pre tabindex="0" class="prism-code language-shell codeBlock_JBFj thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_vKmw"><span class="token-line" style="color:#F8F8F2"><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">HELP</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;yes&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> print </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">${${HELP</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">:+</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">help enabled}</span><span class="token plain">:-help disabled</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> ▶ </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">help</span><span class="token plain"> enabled</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">HELP</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> print </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">${${HELP</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">:+</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">help enabled}</span><span class="token plain">:-help disabled</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> ▶ </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">help</span><span class="token plain"> disabled</span><br></span></code></pre><button type="button" aria-label="クリップボードにコードをコピー" class="copyButton_RlMu clean-btn">コピー</button></div></div><p>Ternary expression is known from <code>C</code> language but exists also in Zsh, but directly only in a math context, i.e.
<code>\(( a = a &gt; 0 ? b : c ))</code>. The flexibility of Zsh allows such expressions also in a normal context. Above is an
example. <code>:+</code> is &quot;if not empty, substitute …&quot; <code>:-</code> is &quot;if empty, substitute …&quot;. You can save a great number of lines of
code with those substitutions, it&#x27;s normally at least 4-lines <code>if</code> condition or lengthy <code>&amp;&amp;</code>/<code>||</code> use.</p><h3 class="anchor anchorWithHideOnScrollNavbar_I3q0" id="ternary-expressions-with--substitution">Ternary expressions with <code>:#</code> substitution<a class="hash-link" href="#ternary-expressions-with--substitution" title="見出しへの直接リンク">​</a></h3><div class="codeBlockContainer_NBvI language-shell theme-code-block"><div class="codeBlockContent_yvht shell"><pre tabindex="0" class="prism-code language-shell codeBlock_JBFj thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_vKmw"><span class="token-line" style="color:#F8F8F2"><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">var</span><span class="token operator">=</span><span class="token plain">abc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> print </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">${${${(M)var</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">:</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">#</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">abc}</span><span class="token plain">:+is abc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">:-not abc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> ▶ is abc</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">var</span><span class="token operator">=</span><span class="token plain">abcd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> print </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">${${${(M)var</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">:</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">#</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">abc}</span><span class="token plain">:+is abc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">:-not abc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> ▶ not abc</span><br></span></code></pre><button type="button" aria-label="クリップボードにコードをコピー" class="copyButton_RlMu clean-btn">コピー</button></div></div><p>A one-line &quot;if var = x, then …, else …&quot;. Again, can spare a great amount of boring code that makes a 10-line function a
20-line one.</p><p>[#built-in-regular-expressions-engine]</p><h3 class="anchor anchorWithHideOnScrollNavbar_I3q0" id="using-built-in-regular-expressions-engine">Using built-in regular expressions engine<a class="hash-link" href="#using-built-in-regular-expressions-engine" title="見出しへの直接リンク">​</a></h3><div class="codeBlockContainer_NBvI language-shell theme-code-block"><div class="codeBlockContent_yvht shell"><pre tabindex="0" class="prism-code language-shell codeBlock_JBFj thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_vKmw"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;aabbb&quot;</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token comment" style="color:rgb(98, 114, 164)">#b)(a##)*(b(#c2,2)) ]] &amp;&amp; print ${match[1]}-${match[2]} ▶ aa-bb</span><br></span></code></pre><button type="button" aria-label="クリップボードにコードをコピー" class="copyButton_RlMu clean-btn">コピー</button></div></div><p><code>\##</code> is: &quot;1 or more&quot;. <code>(#c2,2)</code> is: &quot;exactly 2&quot;. A few other constructs: <code>#</code> is &quot;0 or more&quot;, <code>?</code> is &quot;any character&quot;,
<code>(a|b|)</code> is &quot;a or b or empty match&quot;. <code>#b</code> enables the <code>$match</code> parameters. There&#x27;s also <code>#m</code> but it has one parameter
<code>$MATCH</code> for whole matched text, not for any parenthesis.</p><p>Zsh patterns are a custom regular expressions engine. They are slightly faster than the <code>zsh/regex</code> module (used for
<code>=~</code> operator) and don&#x27;t have that dependency (regex module can be not present, e.g. in default static build of Zsh).
Also, they can be used in substitutions, for example in <code>//</code> substitution.</p><h3 class="anchor anchorWithHideOnScrollNavbar_I3q0" id="skipping-uniq">Skipping uniq<a class="hash-link" href="#skipping-uniq" title="見出しへの直接リンク">​</a></h3><div class="codeBlockContainer_NBvI language-shell theme-code-block"><div class="codeBlockContent_yvht shell"><pre tabindex="0" class="prism-code language-shell codeBlock_JBFj thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_vKmw"><span class="token-line" style="color:#F8F8F2"><span class="token builtin class-name" style="color:rgb(189, 147, 249)">declare</span><span class="token plain"> -aU array</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">array</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> a a b </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> print </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$array</span><span class="token plain"> ▶ a b</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">declare</span><span class="token plain"> -a array</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">array</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> a a b </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> print </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">${(u)array}</span><span class="token plain"> ▶ a b</span><br></span></code></pre><button type="button" aria-label="クリップボードにコードをコピー" class="copyButton_RlMu clean-btn">コピー</button></div></div><p>Enable <code>-U</code> flag for array so that it guards elements to be unique, or use <code>u</code>-flag to make unique elements of an array.</p><h3 class="anchor anchorWithHideOnScrollNavbar_I3q0" id="skipping-awk">Skipping awk<a class="hash-link" href="#skipping-awk" title="見出しへの直接リンク">​</a></h3><div class="codeBlockContainer_NBvI language-shell theme-code-block"><div class="codeBlockContent_yvht shell"><pre tabindex="0" class="prism-code language-shell codeBlock_JBFj thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_vKmw"><span class="token-line" style="color:#F8F8F2"><span class="token builtin class-name" style="color:rgb(189, 147, 249)">declare</span><span class="token plain"> -a list</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">list</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;a,b,c,1,e&quot;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;p,q,r,2,t&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">print </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">${list</span><span class="token string variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">[</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">@</span><span class="token string variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">]</span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">/</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">(</span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">#</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">b)(</span><span class="token string variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">[</span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">^</span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">,</span><span class="token string variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">]</span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">##</span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">,</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)(</span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">#</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">c3</span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">,</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">3)(</span><span class="token string variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">[</span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">^</span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">,</span><span class="token string variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">]</span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">##</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)*</span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">/</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">${match</span><span class="token string variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">[</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">2</span><span class="token string variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">]</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">}</span><span class="token string" style="color:rgb(255, 121, 198)">}&quot;</span><span class="token plain"> ▶ </span><span class="token number">1</span><span class="token plain"> </span><span class="token number">2</span><br></span></code></pre><button type="button" aria-label="クリップボードにコードをコピー" class="copyButton_RlMu clean-btn">コピー</button></div></div><p>The pattern specifies 3 blocks of <code>[^,]##,</code> so 3 &quot;not-comma multiple times, then comma&quot;, then the single block of
&quot;not-comma multiple times&quot; in second parentheses -- and then replaces this with second parentheses. The result is the
4th column extracted from multiple lines of text, something <code>awk</code> is often used for. Another method is the use of the
<code>s</code>-flag. For a single line of text:</p><div class="codeBlockContainer_NBvI language-shell theme-code-block"><div class="codeBlockContent_yvht shell"><pre tabindex="0" class="prism-code language-shell codeBlock_JBFj thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_vKmw"><span class="token-line" style="color:#F8F8F2"><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">text</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;a,b,c,1,e&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> print </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">${${(s</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">:</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">,</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">:</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">)text}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">4</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> ▶ </span><span class="token number">1</span><br></span></code></pre><button type="button" aria-label="クリップボードにコードをコピー" class="copyButton_RlMu clean-btn">コピー</button></div></div><p>Thanks to in-substitution code-execution capabilities it&#x27;s possible to use <code>s</code>-flag to apply it to multiple lines:</p><div class="codeBlockContainer_NBvI language-shell theme-code-block"><div class="codeBlockContent_yvht shell"><pre tabindex="0" class="prism-code language-shell codeBlock_JBFj thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_vKmw"><span class="token-line" style="color:#F8F8F2"><span class="token builtin class-name" style="color:rgb(189, 147, 249)">declare</span><span class="token plain"> -a list</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">list</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;a,b,c,1,e&quot;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;p,q,r,2,t&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">print </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">${list</span><span class="token string variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">[</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">@</span><span class="token string variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">]</span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">/</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">(</span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">#</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">m)*</span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">/</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">${${(s</span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">:</span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">,</span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">:</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)MATCH}</span><span class="token string" style="color:rgb(255, 121, 198)">[4]}}&quot;</span><span class="token plain"> ▶ </span><span class="token number">1</span><span class="token plain"> </span><span class="token number">2</span><br></span></code></pre><button type="button" aria-label="クリップボードにコードをコピー" class="copyButton_RlMu clean-btn">コピー</button></div></div><p>There is a problem with the <code>(s::)</code> flag that can be solved if Zsh is version <code>5.4</code> or higher: if there will be single
input column, e.g. <code>list=( &quot;column1&quot; &quot;a,b&quot;)</code> instead of two or more columns (i.e. <code>list=( &quot;column1,column2&quot; &quot;a,b&quot; )</code>),
then <code>(s::)</code> will return <strong>string</strong> instead of 1-element <strong>array</strong>. So the index <code>[4]</code> in the above snippet will index a
string, and show its 4-th letter. Starting with Zsh 5.4, thanks to a patch by Bart Schaefer
(<code>40640: the (A) parameter flag forces array result even if...</code>), it is possible to force <strong>array</strong>-kind of result even
for a single column, by adding <code>(A)</code> flag, i.e.:</p><div class="codeBlockContainer_NBvI language-shell theme-code-block"><div class="codeBlockContent_yvht shell"><pre tabindex="0" class="prism-code language-shell codeBlock_JBFj thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_vKmw"><span class="token-line" style="color:#F8F8F2"><span class="token builtin class-name" style="color:rgb(189, 147, 249)">declare</span><span class="token plain"> -a list</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">list</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;a,b,c,1,e&quot;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;p,q,r,2,t&quot;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;column1&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">print </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">${list</span><span class="token string variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">[</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">@</span><span class="token string variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">]</span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">/</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">(</span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">#</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">m)*</span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">/</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">${${(As</span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">:</span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">,</span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">:</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)MATCH}</span><span class="token string" style="color:rgb(255, 121, 198)">[4]}}&quot;</span><span class="token plain"> ▶ </span><span class="token number">1</span><span class="token plain"> </span><span class="token number">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">print </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">${list</span><span class="token string variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">[</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">@</span><span class="token string variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">]</span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">/</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">(</span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">#</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">m)*</span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">/</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">${${(s</span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">:</span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">,</span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">:</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)MATCH}</span><span class="token string" style="color:rgb(255, 121, 198)">[4]}}&quot;</span><span class="token plain"> ▶ </span><span class="token number">1</span><span class="token plain"> </span><span class="token number">2</span><span class="token plain"> u</span><br></span></code></pre><button type="button" aria-label="クリップボードにコードをコピー" class="copyButton_RlMu clean-btn">コピー</button></div></div><p>Side-note: <code>(A)</code> flag is often used together with <code>::=</code> assignment-substitution and <code>(P)</code> flag, to assign arrays and
hashes by-name.</p><h3 class="anchor anchorWithHideOnScrollNavbar_I3q0" id="searching-arrays">Searching arrays<a class="hash-link" href="#searching-arrays" title="見出しへの直接リンク">​</a></h3><div class="codeBlockContainer_NBvI language-shell theme-code-block"><div class="codeBlockContent_yvht shell"><pre tabindex="0" class="prism-code language-shell codeBlock_JBFj thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_vKmw"><span class="token-line" style="color:#F8F8F2"><span class="token builtin class-name" style="color:rgb(189, 147, 249)">declare</span><span class="token plain"> -a array</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">array</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> a b </span><span class="token string" style="color:rgb(255, 121, 198)">&quot; c1&quot;</span><span class="token plain"> d </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> print </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">${array</span><span class="token variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">[</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">(r)</span><span class="token variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">[</span><span class="token variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">[</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">:</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">space</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">:</span><span class="token variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">]</span><span class="token variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">]</span><span class="token variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">[</span><span class="token variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">[</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">:</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">alpha</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">:</span><span class="token variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">]</span><span class="token variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">]</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">*</span><span class="token variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">]</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">}</span><span class="token plain"> ▶ c1</span><br></span></code></pre><button type="button" aria-label="クリップボードにコードをコピー" class="copyButton_RlMu clean-btn">コピー</button></div></div><p><code>\[[:space:]]</code> contains unicode spaces. This is often used in conditional expression like <code>[[ -z ${array[(r)...]} ]]</code>.</p><p>Note that <a href="#skipping-grep">Skipping grep</a> that uses <code>:#</code> substitution can also be used to search arrays.</p><h3 class="anchor anchorWithHideOnScrollNavbar_I3q0" id="code-execution-in--substitution">Code execution in <code>//</code> substitution<a class="hash-link" href="#code-execution-in--substitution" title="見出しへの直接リンク">​</a></h3><div class="codeBlockContainer_NBvI language-shell theme-code-block"><div class="codeBlockContent_yvht shell"><pre tabindex="0" class="prism-code language-shell codeBlock_JBFj thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_vKmw"><span class="token-line" style="color:#F8F8F2"><span class="token function-name function" style="color:rgb(80, 250, 123)">append</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">gathered</span><span class="token operator">+=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$array</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">functions -M append </span><span class="token number">1</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"> append</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">declare</span><span class="token plain"> -a array</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">array</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Value 1&quot;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Other data&quot;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Value 2&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">declare</span><span class="token plain"> -a gathered</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> integer </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">idx</span><span class="token operator">=</span><span class="token number">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">${array</span><span class="token variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">[</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">@</span><span class="token variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">]</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">/</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">(</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">#</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">b)(Value (</span><span class="token variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">[</span><span class="token variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">[</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">:</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">digit</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">:</span><span class="token variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">]</span><span class="token variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">]</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">##</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">)|*)</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">/</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$(( ${</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">#</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">match</span><span class="token variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">[</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">2</span><span class="token variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">]</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">}</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token number">0</span><span class="token plain"> ? append</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">++idx</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> ++idx </span><span class="token punctuation" style="color:rgb(248, 248, 242)">))</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">print </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$gathered</span><span class="token plain"> ▶ Value </span><span class="token number">1</span><span class="token plain"> Value </span><span class="token number">2</span><br></span></code></pre><button type="button" aria-label="クリップボードにコードをコピー" class="copyButton_RlMu clean-btn">コピー</button></div></div><p>Use of <code>#b</code> glob flag enables math-code execution (and not only) in <code>/</code> and <code>//</code> substitutions. Implementation is very
fast.</p><h3 class="anchor anchorWithHideOnScrollNavbar_I3q0" id="serializing-data">Serializing data<a class="hash-link" href="#serializing-data" title="見出しへの直接リンク">​</a></h3><div class="codeBlockContainer_NBvI language-shell theme-code-block"><div class="codeBlockContent_yvht shell"><pre tabindex="0" class="prism-code language-shell codeBlock_JBFj thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_vKmw"><span class="token-line" style="color:#F8F8F2"><span class="token builtin class-name" style="color:rgb(189, 147, 249)">declare</span><span class="token plain"> -A hsh deserialized</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">hsh</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> key value </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">serialized</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">${(j</span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">:</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">:</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)${(qkv@)hsh}</span><span class="token string" style="color:rgb(255, 121, 198)">}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">deserialized</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">${(Q@)${(z@)serialized}</span><span class="token string" style="color:rgb(255, 121, 198)">}&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">print </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">${(kv)deserialized}</span><span class="token plain"> ▶ key value</span><br></span></code></pre><button type="button" aria-label="クリップボードにコードをコピー" class="copyButton_RlMu clean-btn">コピー</button></div></div><p><code>j</code>-flag means join -- by spaces, in this case. Flags <code>kv</code> mean: keys and values, interleaving. Important <code>q</code>-flag
means: quote. So what is obtained is each key and value quoted, and put into a string separated by spaces.</p><p><code>z</code>-flag means: split as if Zsh parser would split. So quoting (with backslashes, double quoting, and others) is
recognized. Obtained is array <code>( &quot;key&quot; &quot;value&quot;)</code> which is then de-quoted with <code>Q</code>-flag. This yields original data,
assigned to hash <code>deserialized</code>. Use this to e.g. implement an array of hashes.</p><p>Note: to be compatible with <code>setopt ksharrays</code>, use <code>[@]</code> instead of <code>(@)</code>, e.g.:
<code>...( &quot;${(Q)${(z)serialized[@]}[@]}&quot; )</code></p><h4 class="anchor anchorWithHideOnScrollNavbar_I3q0" id="tip-serializing-with-bash">Tip: serializing with Bash<a class="hash-link" href="#tip-serializing-with-bash" title="見出しへの直接リンク">​</a></h4><div class="codeBlockContainer_NBvI language-shell theme-code-block"><div class="codeBlockContent_yvht shell"><pre tabindex="0" class="prism-code language-shell codeBlock_JBFj thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_vKmw"><span class="token-line" style="color:#F8F8F2"><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">array</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> key1 key2 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">printf</span><span class="token plain"> -v serialized </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;%q &quot;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">${array</span><span class="token string variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">[</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">@</span><span class="token string variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">]</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">}</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">eval</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;deserialized=(</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$serialized</span><span class="token string" style="color:rgb(255, 121, 198)">)&quot;</span><br></span></code></pre><button type="button" aria-label="クリップボードにコードをコピー" class="copyButton_RlMu clean-btn">コピー</button></div></div><p>This method works also with Zsh. The drawback is the use of <code>eval</code>, however, no problem may occur unless someone
compromises variable&#x27;s value, but as always, <code>eval</code> should be avoided if possible.</p><h2 class="anchor anchorWithHideOnScrollNavbar_I3q0" id="real-world-examples">Real-world examples<a class="hash-link" href="#real-world-examples" title="見出しへの直接リンク">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_I3q0" id="testing-for-git-subcommand">Testing for Git subcommand<a class="hash-link" href="#testing-for-git-subcommand" title="見出しへの直接リンク">​</a></h3><p>Following code checks, if there is a <code>git</code> subcommand <code>$mysub</code>:</p><div class="codeBlockContainer_NBvI language-shell theme-code-block"><div class="codeBlockContent_yvht shell"><pre tabindex="0" class="prism-code language-shell codeBlock_JBFj thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_vKmw"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">git</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">help</span><span class="token plain"> -a </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;^  [a-z]&quot;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">tr</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27; &#x27;</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;\n&#x27;</span><span class="token plain"> </span><span class="token operator">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">grep</span><span class="token plain"> -x </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$mysub</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> /dev/null </span><span class="token operator">&gt;</span><span class="token plain"> /dev/null</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">then</span><br></span></code></pre><button type="button" aria-label="クリップボードにコードをコピー" class="copyButton_RlMu clean-btn">コピー</button></div></div><p>Those are <code>4</code> forks. The code can be replaced according to this guide:</p><div class="codeBlockContainer_NBvI language-shell theme-code-block"><div class="codeBlockContent_yvht shell"><pre tabindex="0" class="prism-code language-shell codeBlock_JBFj thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_vKmw"><span class="token-line" style="color:#F8F8F2"><span class="token builtin class-name" style="color:rgb(189, 147, 249)">local</span><span class="token plain"> -a lines_list</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">lines_list</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">${(f)&quot;$(git help -a)&quot;}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">lines_list</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"> </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">${(M)${(s</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">:</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">:</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">)${(M)lines_list</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">:</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">#</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">   </span><span class="token variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">[</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">a-z</span><span class="token variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">]</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">*}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain">:</span><span class="token comment" style="color:rgb(98, 114, 164)">#$mysub} )</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">((</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> ${#lines_list} </span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">&gt;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable number" style="color:rgb(189, 147, 249);font-style:italic">0</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">))</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">then</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    …</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">fi</span><br></span></code></pre><button type="button" aria-label="クリップボードにコードをコピー" class="copyButton_RlMu clean-btn">コピー</button></div></div><p>The result is just <code>1</code> fork.</p><h3 class="anchor anchorWithHideOnScrollNavbar_I3q0" id="counting-unquoted-only-apostrophes">Counting unquoted-only apostrophes<a class="hash-link" href="#counting-unquoted-only-apostrophes" title="見出しへの直接リンク">​</a></h3><p>A project was needing this to do some Zle line-continuation tricks (when you put a backslash-\ at the end of the line
and press enters – it is the line-continuation that occurs at that moment).</p><p>The required functionality is: in the given string, count the number of apostrophes, but <em>only the unquoted ones</em>. This
means that only apostrophes with null or an even number of preceding backslashes should be accepted into the count:</p><div class="codeBlockContainer_NBvI language-shell theme-code-block"><div class="codeBlockContent_yvht shell"><pre tabindex="0" class="prism-code language-shell codeBlock_JBFj thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_vKmw"><span class="token-line" style="color:#F8F8F2"><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">buf</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;word&#x27;continue\&#x27;after</span><span class="token string entity" style="color:rgb(255, 121, 198)">\\</span><span class="token string" style="color:rgb(255, 121, 198)">\&#x27;afterSecnd</span><span class="token string entity" style="color:rgb(255, 121, 198)">\\</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;&#x27;afterPair&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">integer </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">count</span><span class="token operator">=</span><span class="token number">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">${buf</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">/</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">/</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">(</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">#</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">b)((</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">#</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">s)|</span><span class="token variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">[</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">^</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">\\</span><span class="token variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">]</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">)(</span><span class="token variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">[</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">\\</span><span class="token variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">]</span><span class="token variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">[</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">\\</span><span class="token variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">]</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">#</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">(\&#x27;\&#x27;</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">#</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">/</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$(( count += ${</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">#</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">match</span><span class="token variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">[</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">3</span><span class="token variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">]</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">))</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$count</span><span class="token plain"> ▶ </span><span class="token number">3</span><br></span></code></pre><button type="button" aria-label="クリップボードにコードをコピー" class="copyButton_RlMu clean-btn">コピー</button></div></div><p>The answer (i.e. the output) to the above presentation and example is: <code>3</code> (there are <code>3</code> unquoted apostrophes in total
in the string kept in the variable <code>$buf</code>).</p><p>Below follows a variation of the above snippet that doesn&#x27;t use math-code execution:</p><div class="codeBlockContainer_NBvI language-shell theme-code-block"><div class="codeBlockContent_yvht shell"><pre tabindex="0" class="prism-code language-shell codeBlock_JBFj thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_vKmw"><span class="token-line" style="color:#F8F8F2"><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">buf</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;word&#x27;continue\&#x27;after</span><span class="token string entity" style="color:rgb(255, 121, 198)">\\</span><span class="token string" style="color:rgb(255, 121, 198)">\&#x27;afterSecnd</span><span class="token string entity" style="color:rgb(255, 121, 198)">\\</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;&#x27;afterPair&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">buf</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">${(S)buf</span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">/</span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">/</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">(</span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">#</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">b)*((</span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">#</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">s)|</span><span class="token string variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">[</span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">^</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">\\</span><span class="token string variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">]</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)(</span><span class="token string variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">[</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">\\</span><span class="token string variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">]</span><span class="token string variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">[</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">\\</span><span class="token string variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">]</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">#</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">(\&#x27;\&#x27;</span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">#</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">)*</span><span class="token string variable operator" style="color:rgb(189, 147, 249);font-style:italic">/</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">${match</span><span class="token string variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">[</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">3</span><span class="token string variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">]</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">}</span><span class="token string" style="color:rgb(255, 121, 198)">}&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">buf</span><span class="token operator">=</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">${buf</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">%%</span><span class="token variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">[</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">^</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">\&#x27;</span><span class="token variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">]</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">##</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">integer </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">count</span><span class="token operator">=</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">${</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">#</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">buf}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$count</span><span class="token plain"> ▶ </span><span class="token number">3</span><br></span></code></pre><button type="button" aria-label="クリップボードにコードをコピー" class="copyButton_RlMu clean-btn">コピー</button></div></div><p>This is possible thanks to <code>(S)</code> flag – non-greedy matching, <code>([\\][\\])#</code> trick – it matches only unquoted following
<code>(\&#x27;\&#x27;##)</code> characters (which are the apostrophes) and a general strategy to replace <code>anything-apostrope(s)</code> (unquoted
ones) with <code>the-apostrope(s)</code> (and then count them with <code>${#buf}</code>).</p><h2 class="anchor anchorWithHideOnScrollNavbar_I3q0" id="tips-and-tricks">Tips and Tricks<a class="hash-link" href="#tips-and-tricks" title="見出しへの直接リンク">​</a></h2><h3 class="anchor anchorWithHideOnScrollNavbar_I3q0" id="parsing-ini-file">Parsing INI file<a class="hash-link" href="#parsing-ini-file" title="見出しへの直接リンク">​</a></h3><p>With Zshell <code>extended_glob</code> parsing an <code>ini</code> file is an easy task. It will not result in a nested-arrays data structure
(Zsh doesn&#x27;t support nested hashes), but the hash keys like <code>$DB_CONF[db1_&lt;connection&gt;_host]</code> is actually intuitive.</p><p>The code should be placed in a file named <code>read-ini-file</code>, in <code>$fpath</code>, and <code>autoload read-ini-file</code> should be invoked.</p><div class="codeBlockContainer_NBvI language-shell theme-code-block"><div class="codeBlockContent_yvht shell"><pre tabindex="0" class="prism-code language-shell codeBlock_JBFj thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_vKmw"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># $1 - path to the ini file to parse</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># $2 - the name of output hash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># $3 - prefix for keys in the hash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Writes to given hash under keys built-in following way: ${3}&lt;section&gt;_field.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Values are values from the ini file. Example invocation:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># read-ini-file ./database1-setup.ini DB_CONF db1_</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># read-ini-file ./database2-setup.ini DB_CONF db2_</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">setopt localoptions extendedglob</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">local</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">__ini_file</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$1</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">__out_hash</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$2</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">__key_prefix</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$3</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">local</span><span class="token plain"> </span><span class="token assign-left variable environment constant" style="color:rgb(189, 147, 249);font-style:italic">IFS</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&#x27;&#x27;</span><span class="token plain"> __line </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">__cur_section</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;void&quot;</span><span class="token plain"> __access_string</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">local</span><span class="token plain"> -a match mbegin mend</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"> </span><span class="token operator">!</span><span class="token plain"> -r </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$__ini_file</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">&amp;&amp;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">builtin</span><span class="token plain"> print -r </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;read-ini-file: an ini file is unreadable (</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$__ini_file</span><span class="token string" style="color:rgb(255, 121, 198)">)&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">return</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">while</span><span class="token plain"> </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">read</span><span class="token plain"> -r -t </span><span class="token number">1</span><span class="token plain"> __line</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">do</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$__line</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">:blank:</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token comment" style="color:rgb(98, 114, 164)">#\;* ]]; then</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">continue</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># Match &quot;[Section]&quot; line</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">elif</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$__line</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token comment" style="color:rgb(98, 114, 164)">#b)[[:blank:]]#\[([^\]]##)\][[:blank:]]# ]]; then</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">__cur_section</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">${match</span><span class="token string variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">[</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">1</span><span class="token string variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">]</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">}</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># Match &quot;string = string&quot; line</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">elif</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">$__line</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token comment" style="color:rgb(98, 114, 164)">#b)[[:blank:]]#([^[:blank:]=]##)[[:blank:]]#[=][[:blank:]]#(*) ]]; then</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        match</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;${match[2]%&quot;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">${match</span><span class="token variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">[</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">2</span><span class="token variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">]</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">##</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">*</span><span class="token variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">[</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">!</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> $&#x27;\t&#x27;</span><span class="token variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">]</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">}</span><span class="token plain">&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token string" style="color:rgb(255, 121, 198)">&quot; # severe trick - remove trailing whitespace</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">        __access_string=&quot;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">${__out_hash}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">${__key_prefix}</span><span class="token operator">&lt;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$__cur_section</span><span class="token operator">&gt;</span><span class="token plain">_</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">${match</span><span class="token variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">[</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">1</span><span class="token variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">]</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">        : &quot;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">${(P)__access_string</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">:</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">:=</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">${match</span><span class="token variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">[</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">2</span><span class="token variable punctuation" style="color:rgb(248, 248, 242);font-style:italic">]</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">    fi</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token string" style="color:rgb(255, 121, 198)">done &lt; &quot;</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$__ini_file</span><span class="token plain">&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">return</span><span class="token plain"> </span><span class="token number">0</span><br></span></code></pre><button type="button" aria-label="クリップボードにコードをコピー" class="copyButton_RlMu clean-btn">コピー</button></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://digitalclouds.crowdin.com/z-shell/ja" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_eFjq" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>このページを編集</a></div><div class="col lastUpdated_I5LP"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="ドキュメントのナビゲーション"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/ja/community/zsh_plugin_standard"><div class="pagination-nav__sublabel">前へ</div><div class="pagination-nav__label">Zsh Plugin Standard</div></a></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div><div class="col col--3"><div class="tableOfContents_wO_i thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#information" class="table-of-contents__link toc-highlight">Information</a><ul><li><a href="#-is-about-keeping-array-form" class="table-of-contents__link toc-highlight">@ is about keeping array form</a></li><li><a href="#extended_glob" class="table-of-contents__link toc-highlight">extended_glob</a></li></ul></li><li><a href="#constructs" class="table-of-contents__link toc-highlight">Constructs</a><ul><li><a href="#reading-a-file" class="table-of-contents__link toc-highlight">Reading a file</a></li><li><a href="#reading-from-stdin" class="table-of-contents__link toc-highlight">Reading from stdin</a></li><li><a href="#skipping-dirname-basename" class="table-of-contents__link toc-highlight">Skipping dirname basename</a></li><li><a href="#resolve-symlinks" class="table-of-contents__link toc-highlight">Resolve Symlinks</a></li><li><a href="#skipping-grep" class="table-of-contents__link toc-highlight">Skipping grep</a><ul><li><a href="#multi-line-matching-like-with-grep" class="table-of-contents__link toc-highlight">Multi-line matching like with grep</a></li></ul></li><li><a href="#pattern-matching-in-and-fashion" class="table-of-contents__link toc-highlight">Pattern matching in AND-fashion</a></li><li><a href="#skipping-tr" class="table-of-contents__link toc-highlight">Skipping tr</a></li><li><a href="#ternary-expressions-with----substitutions" class="table-of-contents__link toc-highlight">Ternary expressions with <code>+,-,:+,:-</code> substitutions</a></li><li><a href="#ternary-expressions-with--substitution" class="table-of-contents__link toc-highlight">Ternary expressions with <code>:#</code> substitution</a></li><li><a href="#using-built-in-regular-expressions-engine" class="table-of-contents__link toc-highlight">Using built-in regular expressions engine</a></li><li><a href="#skipping-uniq" class="table-of-contents__link toc-highlight">Skipping uniq</a></li><li><a href="#skipping-awk" class="table-of-contents__link toc-highlight">Skipping awk</a></li><li><a href="#searching-arrays" class="table-of-contents__link toc-highlight">Searching arrays</a></li><li><a href="#code-execution-in--substitution" class="table-of-contents__link toc-highlight">Code execution in <code>//</code> substitution</a></li><li><a href="#serializing-data" class="table-of-contents__link toc-highlight">Serializing data</a><ul><li><a href="#tip-serializing-with-bash" class="table-of-contents__link toc-highlight">Tip: serializing with Bash</a></li></ul></li></ul></li><li><a href="#real-world-examples" class="table-of-contents__link toc-highlight">Real-world examples</a><ul><li><a href="#testing-for-git-subcommand" class="table-of-contents__link toc-highlight">Testing for Git subcommand</a></li><li><a href="#counting-unquoted-only-apostrophes" class="table-of-contents__link toc-highlight">Counting unquoted-only apostrophes</a></li></ul></li><li><a href="#tips-and-tricks" class="table-of-contents__link toc-highlight">Tips and Tricks</a><ul><li><a href="#parsing-ini-file" class="table-of-contents__link toc-highlight">Parsing INI file</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/ja/docs/intro"><span>Introduction</span></a></li><li class="footer__item"><a class="footer__link-item" href="/ja/community/intro"><span>Community Docs</span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/z-shell/community/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub Discussions<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_N6EJ"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://matrix.to/#/#zi:matrix.org" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Matrix.org<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_N6EJ"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://twitter.com/zshell_zi/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Twitter.com<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_N6EJ"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/z-shell/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub Organization<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_N6EJ"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://digitalclouds.crowdin.com/z-shell/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Crowdin Translations<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_N6EJ"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a class="footer__link-item" href="/ja/blog"><span>Blog</span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Legal</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/ja/legal/privacy_policy/"><span>Privacy Policy</span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Digital Clouds, Z-Shell ❮ ZI ❯ Community.</div></div></div></footer></div>
<script src="/ja/assets/js/runtime~main.40e568a4.js"></script>
<script src="/ja/assets/js/main.5536902d.js"></script>
</body>
</html>